<!DOCTYPE html>

<html lang="cn">

<head>
    
    <title>如何实现复制Excel内容更新数据 - XHX Blog</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="blog,programmer">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="¶背景   上季度在迭代通用策略的时候，曾经尝试迁移 PHP 版本的策略数据上传功能到 Java 后台，最后结果是配置管理部分的都完成了迁移（技术难度较低），但是相对而言，修改下载下来的 Excel 数据，然后复制内容到文本域里实现上传更新的功能就复杂的多，在上次的迁移中以失败告终，没有顺利迁移过来。   这个季度需要做的需求”智能调拨“也有类似的技术点：需要实现智能调拨方案的下载数据和修改数据，">
<meta property="og:type" content="article">
<meta property="og:title" content="如何实现复制Excel内容更新数据">
<meta property="og:url" content="http://xiaohaoxing.xyz/2020/05/15/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%A4%8D%E5%88%B6Excel%E5%86%85%E5%AE%B9%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE/index.html">
<meta property="og:site_name" content="XHX Blog">
<meta property="og:description" content="¶背景   上季度在迭代通用策略的时候，曾经尝试迁移 PHP 版本的策略数据上传功能到 Java 后台，最后结果是配置管理部分的都完成了迁移（技术难度较低），但是相对而言，修改下载下来的 Excel 数据，然后复制内容到文本域里实现上传更新的功能就复杂的多，在上次的迁移中以失败告终，没有顺利迁移过来。   这个季度需要做的需求”智能调拨“也有类似的技术点：需要实现智能调拨方案的下载数据和修改数据，">
<meta property="og:locale">
<meta property="og:image" content="http://xiaohaoxing.xyz/images/%E7%AD%96%E7%95%A5%E6%9B%B4%E6%96%B0.png">
<meta property="og:image" content="http://xiaohaoxing.xyz/images/%E6%99%BA%E8%83%BD%E8%B0%83%E6%8B%A8%E6%9B%B4%E6%96%B0.png">
<meta property="article:published_time" content="2020-05-15T09:03:42.000Z">
<meta property="article:modified_time" content="2021-08-08T18:35:04.402Z">
<meta property="article:author" content="Xiao Haoxing">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="技术方案">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xiaohaoxing.xyz/images/%E7%AD%96%E7%95%A5%E6%9B%B4%E6%96%B0.png">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/justifiedGallery/justifiedGallery.min.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1694670087697">
    
    <link rel="stylesheet" href="/css/style.css?v=1694670087697">

    
        
            <link rel="stylesheet" href="/custom.css?v=1694670087697">
        
    
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="mdui-drawer-body-left">
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/cover/5c3aec85a4343.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Xiao Haoxing" class="mdui-btn mdui-btn-icon"><img src="/../../images/header.jpg" alt="Xiao Haoxing"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Xiao Haoxing">
            <img src="/../../images/header.jpg" alt="Xiao Haoxing" alt="Xiao Haoxing">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>12</div>
        <div><span>Tags</span>13</div>
        <div><span>Categories</span>0</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
        
        
        
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/drools/" style="font-size: 10px;">drools</a> <a href="/tags/frp/" style="font-size: 10px;">frp</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/tags/mi/" style="font-size: 10px;">mi</a> <a href="/tags/productivity/" style="font-size: 10px;">productivity</a> <a href="/tags/spring-boot/" style="font-size: 10px;">spring-boot</a> <a href="/tags/spring-security/" style="font-size: 10px;">spring-security</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">技术</a> <a href="/tags/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/" style="font-size: 10px;">技术方案</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 20px;">教程</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(13);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2023 Xiao Haoxing
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
    
        <div class="nexmoe-post-cover mdui-ripple text"> 
            <img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/cover/5c3aec85a4343.jpg" alt="如何实现复制Excel内容更新数据" loading="lazy">
            <h1>如何实现复制Excel内容更新数据</h1>
        </div>
    
    
    <div class="nexmoe-post-meta nexmoe-rainbow">
    <a><i class="nexmoefont icon-calendar-fill"></i>2020年05月15日</a>
    
    
    <a><i class="nexmoefont icon-areachart"></i>约2.2k字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>预计需要8分钟</a>

</div>

    <h2 id="背景"><a class="header-anchor" href="#背景">¶</a>背景</h2>
<p>  上季度在迭代通用策略的时候，曾经尝试迁移 PHP 版本的策略数据上传功能到 Java 后台，最后结果是配置管理部分的都完成了迁移（技术难度较低），但是相对而言，修改下载下来的 Excel 数据，然后复制内容到文本域里实现上传更新的功能就复杂的多，在上次的迁移中以失败告终，没有顺利迁移过来。</p>
<p>  这个季度需要做的需求”智能调拨“也有类似的技术点：需要实现智能调拨方案的下载数据和修改数据，然后上传覆盖更新，还需要记录更新日志。不一样的业务场景，相似的技术点，不过最大的不同在于：这次的方案全盘由我自己来决策，需要什么字段自己加，需要执行什么操作自己构思；自由发挥的空间很大。因此心中就决心这次一定要把这个功能做好。</p>
<p><strong>策略更新的信息</strong></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="/images/%E7%AD%96%E7%95%A5%E6%9B%B4%E6%96%B0.png" alt="策略更新表" data-caption="策略更新表" loading="lazy"></p>
<span id="more"></span>
<p><strong>智能调拨更新的信息</strong></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="/images/%E6%99%BA%E8%83%BD%E8%B0%83%E6%8B%A8%E6%9B%B4%E6%96%B0.png" alt="智能调拨更新表" data-caption="智能调拨更新表" loading="lazy"></p>
<h2 id="构思"><a class="header-anchor" href="#构思">¶</a>构思</h2>
<p>  在回忆上次开发通用策略的经验中和对本次智能调拨方案的拆解的过程中，我将上传数据更新的难点拆分为如下几个点：</p>
<h3 id="表格数据的校验"><a class="header-anchor" href="#表格数据的校验">¶</a>表格数据的校验</h3>
<p>  数据进入后台第一步就是需要对传入的数据进行校验，其实不仅仅是上传更新，所有的接口都应该对入参进行校验，只是该场景下”非结构化数据——String“ 转换成”结构化数据——表格“所需要进行的校验相对更麻烦。我这里对智能调拨方案的数据校验分成2步：</p>
<p>  第一步，表头的验证。验证表格的列数是否和原始数据一致，顺序是否一致。这里从库表中按照指定的排序（一般按照 <code>id</code> 排序，策略字段表有 <code>order</code> 字段，可以用自定义排序顺序）取出期望的列信息，并存入到 <code>ArrayList</code> 这种有序的列表中进行比对。</p>
<p>  第二步，数据行数的验证。智能调拨方案导入需要保证数据行数和原始数据一致，因此这里把原始表中的记录也全数查出按照特定顺序(这里是用的商品 ID 排序)，并和入参逐行对比确认所有的行都是正确的顺序，并且和上一步的表头长度对比，确认每一行都不缺数。通用策略那边不需要保证行数一致，但是需要保证数据列一致，因此这一步也不能省略。</p>
<h3 id="数据项更新或新增的判断"><a class="header-anchor" href="#数据项更新或新增的判断">¶</a>数据项更新或新增的判断</h3>
<p>  数据项是新增还是更新是根据数据库中是否有记录决定的，智能调拨这里是根据原始数量是否等于0确定的，通用策略是通过索引字段是否一致确定的。两者形式不同，但都需要做更新/新增的判断。智能调拨判断的逻辑如下：</p>
<pre class="language-java" data-language="java"><code class="language-java">updates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>update <span class="token operator">-></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getNumFrom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 从无到有要新增记录</span>
    itemService<span class="token punctuation">.</span><span class="token function">insertDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getNumTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 从有到无要删除记录</span>
    itemService<span class="token punctuation">.</span><span class="token function">deleteDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 否则更新记录</span>
    itemService<span class="token punctuation">.</span><span class="token function">updateDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>  非常简单的实现了新增/更新判断。</p>
<p>  通用策略的新增/更新判断需要根据索引字段确认，目前索引字段是通过取数据手动拼接实现的，后续计划在表中冗余该字段提高性能，同时也实现了对修改索引而不需要清空数据。这里判断新增/更新的逻辑如下：</p>
<pre class="language-java" data-language="java"><code class="language-java">updates<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span>update <span class="token operator">-></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>existIndexes<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    strategyDataDoMapper<span class="token punctuation">.</span><span class="token function">updateData</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> existIndexes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strategyId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    strategyDataDoMapper<span class="token punctuation">.</span><span class="token function">insertData</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> strategyId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>  实现新增/更新判断同样也不复杂。</p>
<h3 id="维度值的转换"><a class="header-anchor" href="#维度值的转换">¶</a>维度值的转换</h3>
<p>  智能调拨方案的维度转换较为有限，仅仅需要仓库维度，场景也仅限于展示表头的仓库信息和日志的仓库信息，使用到维度转换只有一类：<code>XmDimensionUtil.getRemote(&quot;mihome&quot;, mihomeId)</code>。不过通用策略场景的所有字段都是通过配置实现，因此维度转换的场景更多样，维度转换+数据结构转换交织在一起，造成了上一次通用策略的接口迁移无比痛苦，总是转着转着就忘记当前的这个字段到底是名称还是键，还存在循环转换的潜在风险。<br>
  这次实现智能调拨的过程将这一部分思路整理清楚了，原则也很简单：信息只拓展不覆盖。用通俗的话说就是：<strong>把 key 和 name 都存起来，就不存在迷惑的可能了</strong>。这一句说起来简单，但是维度信息是用户配置，实践起来可能仍有一些坑需要踩。</p>
<h2 id="实现"><a class="header-anchor" href="#实现">¶</a>实现</h2>
<p>  考虑完所有的坑之后，实现起来就比较顺利了，也比较幸运，用了大约半天（4-6小时）一口气实现了这部分的代码。自我感觉在没有大量注释的情况下可读性还是不错的~这里直接抛出来供大家鞭策指正。</p>
<h3 id="service-代码"><a class="header-anchor" href="#service-代码">¶</a>service 代码</h3>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">importTransferPlanDetail</span><span class="token punctuation">(</span><span class="token class-name">Long</span> planId<span class="token punctuation">,</span> <span class="token class-name">String</span> data<span class="token punctuation">,</span> <span class="token class-name">Long</span> operator<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token class-name">TransferPlanDO</span> plan <span class="token operator">=</span> transferPlanMapper<span class="token punctuation">.</span><span class="token function">selectPlanByPlanId</span><span class="token punctuation">(</span>planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>plan <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CommonException</span><span class="token punctuation">(</span><span class="token class-name">ErrorCodeEnum</span><span class="token punctuation">.</span>TRANSFER_PLAN_NOT_EXIST<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>plan<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">TransferConst<span class="token punctuation">.</span>PlanStatus</span><span class="token punctuation">.</span>CREATED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CommonException</span><span class="token punctuation">(</span><span class="token class-name">ErrorCodeEnum</span><span class="token punctuation">.</span>TRANSFER_PLAN_NOT_EDITABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token class-name">TransferPlanDetailBO</span> bo <span class="token operator">=</span> <span class="token function">getTransferPlanDetail</span><span class="token punctuation">(</span>planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">StringBuilder</span> err <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// 验证数据 + 获取数据的更新信息</span>
      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransferPlanDetailRecordUpdateBO</span><span class="token punctuation">></span></span> updates <span class="token operator">=</span> <span class="token function">getUpdates</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> bo<span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> err<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token comment">// 更新数据库详情数据</span>
      updates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>update <span class="token operator">-></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getNumFrom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 从无到有要新增记录</span>
  itemService<span class="token punctuation">.</span><span class="token function">insertDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getNumTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 从有到无要删除记录</span>
  itemService<span class="token punctuation">.</span><span class="token function">deleteDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 否则更新记录</span>
  itemService<span class="token punctuation">.</span><span class="token function">updateDetailRecord</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> planId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 更新调拨方案更新时间</span>
      transferPlanMapper<span class="token punctuation">.</span><span class="token function">updateTime</span><span class="token punctuation">(</span>planId<span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 写入日志</span>
      logService<span class="token punctuation">.</span><span class="token function">logImport</span><span class="token punctuation">(</span>operator<span class="token punctuation">,</span> planId<span class="token punctuation">,</span> updates<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      err<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> err<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span></code></pre>
<h3 id="update-函数部分"><a class="header-anchor" href="#update-函数部分">¶</a>update 函数部分</h3>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransferPlanDetailRecordUpdateBO</span><span class="token punctuation">></span></span> <span class="token function">getUpdates</span><span class="token punctuation">(</span><span class="token class-name">String</span> data<span class="token punctuation">,</span> <span class="token class-name">TransferPlanDetailBO</span> bo<span class="token punctuation">,</span> <span class="token class-name">StringBuilder</span> err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rows <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"[\n]+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rows<span class="token punctuation">.</span>length <span class="token operator">!=</span> bo<span class="token punctuation">.</span><span class="token function">getDatas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"数据行数错误！需要"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>bo<span class="token punctuation">.</span><span class="token function">getDatas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"行。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> headers <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"[\t]+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dataRows <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PlanDetailHeaderBO</span><span class="token punctuation">[</span><span class="token punctuation">]</span> existHeaders <span class="token operator">=</span> bo<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlanDetailHeaderBO</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> existDataRows <span class="token operator">=</span> bo<span class="token punctuation">.</span><span class="token function">getDatas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>existHeaders<span class="token punctuation">.</span>length <span class="token operator">!=</span> headers<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"表头列数错误！需要"</span> <span class="token operator">+</span> existHeaders<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">"列。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 验证表头</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> existDataRows<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>headers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>existHeaders<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            err<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"表头缺少["</span> <span class="token operator">+</span> existHeaders<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TransferPlanDetailRecordUpdateBO</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 验证数据</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> existDataRows<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cells <span class="token operator">=</span> dataRows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"[\t]+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> existRow <span class="token operator">=</span> existDataRows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> currentGoodsId <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>existRow<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"goods_id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> currentGoodsName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> existRow<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"goods_name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> currentSku <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> existRow<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"sku"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cells<span class="token punctuation">.</span>length <span class="token operator">!=</span> existRow<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"第"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"行数据列数错误！需要"</span> <span class="token operator">+</span> existRow<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"列。\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">boolean</span> goodsId <span class="token operator">=</span> cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currentGoodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> goodsName <span class="token operator">=</span> cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currentGoodsName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> sku <span class="token operator">=</span> cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currentSku<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>goodsId <span class="token operator">||</span> <span class="token operator">!</span>goodsName <span class="token operator">||</span> <span class="token operator">!</span>sku<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            err<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"第"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"行数据商品信息有误，应为"</span> <span class="token operator">+</span> currentGoodsName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cells<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">String</span> currentCellInfo <span class="token operator">=</span> existHeaders<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"调拨"</span> <span class="token operator">+</span> currentGoodsName<span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// 转换数据</span>
                <span class="token class-name">Integer</span> preNum <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">)</span> existRow<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>existHeaders<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDataIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Integer</span> newNum <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cells<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>newNum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    err<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>currentCellInfo <span class="token operator">+</span> <span class="token string">"数据有误，请检查。\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>preNum<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>newNum<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mihomePair <span class="token operator">=</span> existHeaders<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDataIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mihomeNamepair <span class="token operator">=</span> existHeaders<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">TransferPlanDetailRecordUpdateBO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">goodsId</span><span class="token punctuation">(</span>currentGoodsId<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">goodsName</span><span class="token punctuation">(</span>currentGoodsName<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">sku</span><span class="token punctuation">(</span>currentSku<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">mihomeFrom</span><span class="token punctuation">(</span>mihomePair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">mihomeTo</span><span class="token punctuation">(</span>mihomePair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">mihomeFromName</span><span class="token punctuation">(</span>mihomeNamepair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">mihomeToName</span><span class="token punctuation">(</span>mihomeNamepair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">numFrom</span><span class="token punctuation">(</span>preNum<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">numTo</span><span class="token punctuation">(</span>newNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                err<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>currentCellInfo <span class="token operator">+</span> <span class="token string">"数据有误，请检查。\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>  <code>getUpdates</code>部分的代码一开始其实是准备把验证和读数分开做的~先验证格式正确性，取出入参的子集数据<code>int[][]</code>，再进行新建/更新判断，但是做的过程中发现没有必要，已经遍历到具体的数值了，对应的原始数值也正好能读到（已有数据的数据结构是用 HashMap 存储的，用<code>dataRow.get([headerName])</code>就可以得到），就直接去生成对应的变更记录列表了。由于违背了一开始的设计思路，所以可能看起来有点乱，如果你有更优雅的实现方式也可以跟我交流下~</p>
<h2 id="后续迭代计划"><a class="header-anchor" href="#后续迭代计划">¶</a>后续迭代计划</h2>
<p>  这里使用了100行不到的代码实现了对上传数据表格更新数据库的具体操作（当然还有前置读取原始数据的步骤），虽然代码不多，但是还是比较锻炼思维能力，我第二次开发才算比较满意的实现了预期的效果，后续计划将对上次未完成的通用策略的数据导入进行开发，进一步提高对这部分技术点的掌握。</p>
<blockquote>
<p>平凡的业务中也有不平凡的闪光点~</p>
</blockquote>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Java/" rel="tag">Java</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/" rel="tag">技术方案</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E6%80%9D"><span class="toc-number">2.</span> <span class="toc-text">构思</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%9A%84%E6%A0%A1%E9%AA%8C"><span class="toc-number">2.1.</span> <span class="toc-text">表格数据的校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A1%B9%E6%9B%B4%E6%96%B0%E6%88%96%E6%96%B0%E5%A2%9E%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-number">2.2.</span> <span class="toc-text">数据项更新或新增的判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%80%BC%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">2.3.</span> <span class="toc-text">维度值的转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#service-%E4%BB%A3%E7%A0%81"><span class="toc-number">3.1.</span> <span class="toc-text">service 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#update-%E5%87%BD%E6%95%B0%E9%83%A8%E5%88%86"><span class="toc-number">3.2.</span> <span class="toc-text">update 函数部分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD%E8%BF%AD%E4%BB%A3%E8%AE%A1%E5%88%92"><span class="toc-number">4.</span> <span class="toc-text">后续迭代计划</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    <div id="nexmoe-search-space">
	<div class="search-container">
		<div class="search-header">
			<div class="search-input-container">
				<input
					class="search-input"
					type="text"
					placeholder="Search"
					oninput="sinput();"
				/>
			</div>
			<a class="search-close" onclick="sclose();">×</a>
		</div>
		<div class="search-body"></div>
	</div>
</div>

    
<script src="/lib/mdui_043tiny/mdui.js"></script>
<script src="/lib/jquery.min.js"></script>
<script src="/lib/justifiedGallery/jquery.justifiedGallery.min.js"></script>
<script src="/lib/fancybox/fancybox.umd.js"></script>


 

<script async src="/js/app.js?v=1694670087721"></script>



<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>

</body>

</html>
