import{_ as u}from"./ValaxyMain.vue_vue_type_script_setup_true_lang.CeNTCbIz.js";import"./chunks/nprogress.DNg93r_p.js";import{e as f,u as c,b as h}from"./chunks/vue-router.CBw7aC2Q.js";import{a7 as y,ai as t,V as v,a8 as $,ad as o,ac as a,ab as b,af as r,X as O}from"./framework.Bv4HAC8f.js";import"./app.D8kfsgPF.js";import"./chunks/dayjs.BdcnXKr1.js";import"./chunks/vue-i18n.CEfar9q1.js";import"./chunks/pinia.DgI55BSL.js";/* empty css                    */const M=f("/posts/solve_mainland_OpenStreetMap_issue",async s=>JSON.parse('{"title":"解决国内 OpenStreetMap 地图无法显示的问题","description":"","frontmatter":{"title":"解决国内 OpenStreetMap 地图无法显示的问题","date":"2023-04-11 00:53:21","cover":"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411011953614.png","categories":null,"tags":["教程"]},"headers":[],"relativePath":"pages/posts/solve_mainland_OpenStreetMap_issue.md","lastUpdated":1761910018000}'),{lazy:(s,i)=>s.name===i.name}),D={__name:"solve_mainland_OpenStreetMap_issue",setup(s,{expose:i}){const{data:m}=M(),p=h(),d=c(),l=Object.assign(d.meta.frontmatter||{},m.value?.frontmatter||{});return p.currentRoute.value.data=m.value,O("valaxy:frontmatter",l),globalThis.$frontmatter=l,i({frontmatter:{title:"解决国内 OpenStreetMap 地图无法显示的问题",date:"2023-04-11 00:53:21",cover:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411011953614.png",categories:null,tags:["教程"]}}),(n,e)=>{const g=u;return $(),y(g,{frontmatter:v(l)},{"main-content-md":t(()=>[e[0]||(e[0]=a("p",null,"今天去开会，了解到师弟那边项目遇到了一个问题：OpenStreetMap 的地图组件在国内网络环境则加载不出来。本着助人为乐的精神，我主动承担了帮助解决这个问题的任务。",-1)),b(" more "),e[1]||(e[1]=a("h2",{id:"❓问题复现",tabindex:"-1"},[r("❓问题复现 "),a("a",{class:"header-anchor",href:"#❓问题复现","aria-label":'Permalink to "❓问题复现"'},"​")],-1)),e[2]||(e[2]=a("p",null,[r("网站地址： "),a("a",{href:"http://sheng.whu.edu.cn/spadas/",target:"_blank",rel:"noreferrer"},"http://sheng.whu.edu.cn/spadas/"),r(", 在打开该地址后，可以看到地图上的标注可以加载，但是底图没有出来。像这样子：")],-1)),e[3]||(e[3]=a("figure",null,[a("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411010153737.png",alt:"image-20230411010153737",loading:"lazy",decoding:"async"})],-1)),e[4]||(e[4]=a("p",null,[r("在打开 F12 网络情况后发现，和其他的地图加载方式一样，OpenStreetMap 也是使用了地图分块图层的方式加载的，每个区块都是单独在域名下 "),a("code",null,"a.tile.openstreetmap.org"),r(" 去获取的。而这个域名通过 ping 发现在国内网络是无法访问的：")],-1)),e[5]||(e[5]=a("figure",null,[a("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411010620924.png",alt:"image-20230411010620924",loading:"lazy",decoding:"async"})],-1)),e[6]||(e[6]=a("p",null,"最终就会导致所有图层的图像获取失败，地图显示空白：",-1)),e[7]||(e[7]=a("figure",null,[a("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411010646445.png",alt:"image-20230411010646445",loading:"lazy",decoding:"async"})],-1)),e[8]||(e[8]=a("h2",{id:"👌-解决方案",tabindex:"-1"},[r("👌 解决方案 "),a("a",{class:"header-anchor",href:"#👌-解决方案","aria-label":'Permalink to "👌 解决方案"'},"​")],-1)),e[9]||(e[9]=a("p",null,[r("确认了问题，下面就是去找对应的解决方案。因为已经定位到是域名的问题，那么接下来就直奔主题，去找 OpenStreetMap 的 CDN 加速方案。经过一番搜寻，最终发现 OpenStreetMap "),a("a",{href:"https://wiki.openstreetmap.org/wiki/Raster_tile_providers",target:"_blank",rel:"noreferrer"},"官网"),r(" 列举出了所有图层数据的服务提供商（免费/商用）域名地址，url 结构大部分为 "),a("code",null,"https://{s}.tile.[DOMAIN]/{z}/{x}/{y}.png"),r("，这和上面的访问失败的结构完全一致，可以断定就是修改这个 URL 即可替换掉图像的获取地址，确保地图的正确加载。")],-1)),e[10]||(e[10]=a("p",null,[r("接下来在项目前端代码里搜索 "),a("code",null,"openstreetmap.org"),r("该域名，很容易找到了对应的配置项："),a("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411011425496.png",alt:"image-20230411011425496"})],-1)),e[11]||(e[11]=a("p",null,"最后把这个 url 模板在网站上找一个访问速度快的地址替换掉，地图不加载的问题就解决了🎉",-1)),e[12]||(e[12]=a("figure",null,[a("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/image-20230411011821681.png",alt:"image-20230411011821681",loading:"lazy",decoding:"async"})],-1))]),"main-header":t(()=>[o(n.$slots,"main-header")]),"main-header-after":t(()=>[o(n.$slots,"main-header-after")]),"main-nav":t(()=>[o(n.$slots,"main-nav")]),"main-content-before":t(()=>[o(n.$slots,"main-content-before")]),"main-content":t(()=>[o(n.$slots,"main-content")]),"main-content-after":t(()=>[o(n.$slots,"main-content-after")]),"main-nav-before":t(()=>[o(n.$slots,"main-nav-before")]),"main-nav-after":t(()=>[o(n.$slots,"main-nav-after")]),comment:t(()=>[o(n.$slots,"comment")]),footer:t(()=>[o(n.$slots,"footer")]),aside:t(()=>[o(n.$slots,"aside")]),"aside-custom":t(()=>[o(n.$slots,"aside-custom")]),default:t(()=>[o(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{D as default,M as usePageData};
