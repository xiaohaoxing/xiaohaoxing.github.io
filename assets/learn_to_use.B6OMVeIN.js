import{_ as g}from"./ValaxyMain.vue_vue_type_script_setup_true_lang.CeNTCbIz.js";import"./chunks/nprogress.DNg93r_p.js";import{e as o,u as y,b as u}from"./chunks/vue-router.CBw7aC2Q.js";import{a7 as F,ai as t,V as m,a8 as A,ad as h,ac as i,ab as D,af as l,X as C}from"./framework.Bv4HAC8f.js";import"./app.D8kfsgPF.js";import"./chunks/dayjs.BdcnXKr1.js";import"./chunks/vue-i18n.CEfar9q1.js";import"./chunks/pinia.DgI55BSL.js";/* empty css                    */const b=o("/posts/learn_to_use",async k=>JSON.parse('{"title":"学以致用","description":"","frontmatter":{"title":"学以致用","date":"2020-04-30 14:22:43","tags":["leetcode"]},"headers":[],"relativePath":"pages/posts/learn_to_use.md","lastUpdated":1761910018000}'),{lazy:(k,n)=>k.name===n.name}),U={__name:"learn_to_use",setup(k,{expose:n}){const{data:r}=b(),d=u(),E=y(),e=Object.assign(E.meta.frontmatter||{},r.value?.frontmatter||{});return d.currentRoute.value.data=r.value,C("valaxy:frontmatter",e),globalThis.$frontmatter=e,n({frontmatter:{title:"学以致用",date:"2020-04-30 14:22:43",tags:["leetcode"]}}),(a,s)=>{const p=g;return A(),F(p,{frontmatter:m(e)},{"main-content-md":t(()=>[s[0]||(s[0]=i("h2",{id:"刷题经历",tabindex:"-1"},[l("刷题经历 "),i("a",{class:"header-anchor",href:"#刷题经历","aria-label":'Permalink to "刷题经历"'},"​")],-1)),s[1]||(s[1]=i("p",null,[l("  最近一直在刷 Leetcode，刚好遇到一个 "),i("a",{href:"https://leetcode.com/problems/reformat-department-table/",target:"_blank",rel:"noreferrer"},"SQL 的题"),l("涉及到没有学习过的知识点。该题描述如下：")],-1)),s[2]||(s[2]=i("blockquote",null,[i("p",null,[l("给定一个数据表 "),i("code",null,"Department"),l("，数据格式如下：")])],-1)),s[3]||(s[3]=i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"id"),i("th",null,"revenue"),i("th",null,"month")])]),i("tbody",null,[i("tr",null,[i("td",null,"1"),i("td",null,"8000"),i("td",null,"Jan")]),i("tr",null,[i("td",null,"2"),i("td",null,"9000"),i("td",null,"Jan")]),i("tr",null,[i("td",null,"3"),i("td",null,"10000"),i("td",null,"Feb")]),i("tr",null,[i("td",null,"1"),i("td",null,"7000"),i("td",null,"Feb")]),i("tr",null,[i("td",null,"1"),i("td",null,"6000"),i("td",null,"Mar")])])],-1)),s[4]||(s[4]=i("blockquote",null,[i("p",null,[l("要求返回的格式是上述数据的按 "),i("code",null,"id"),l(" 和 "),i("code",null,"month"),l(" 进行聚合，但是列同时还是按月进行切分的。也就是说，行方向是根据 id 区分的，列方向是根据 month 区分的，如下表：")])],-1)),D(" more "),s[5]||(s[5]=i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"id"),i("th",null,"Jan_Revenue"),i("th",null,"Feb_Revenue"),i("th",null,"Mar_Revenue"),i("th",null,"…"),i("th",null,"Dec_Revenue")])]),i("tbody",null,[i("tr",null,[i("td",null,"1"),i("td",null,"8000"),i("td",null,"7000"),i("td",null,"6000"),i("td",null,"…"),i("td",null,"null")]),i("tr",null,[i("td",null,"2"),i("td",null,"9000"),i("td",null,"null"),i("td",null,"null"),i("td",null,"…"),i("td",null,"null")]),i("tr",null,[i("td",null,"3"),i("td",null,"null"),i("td",null,"10000"),i("td",null,"null"),i("td",null,"…"),i("td",null,"null")])])],-1)),s[6]||(s[6]=i("p",null,"  这种一看就知道用常规语法就无法做到，所以当时直接去查了答案，答案也很简单：",-1)),s[7]||(s[7]=i("div",{class:"language-sql"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sql"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"select")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    id,")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Jan'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Jan_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Feb'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Feb_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Mar'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Mar_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Apr'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Apr_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'May'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'May_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Jun'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Jun_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Jul'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Jul_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Aug'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Aug_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Sep'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Sep_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Oct'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Oct_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Nov'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Nov_Revenue'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    SUM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CASE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," WHEN"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," month="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'Dec'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," then"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," revenue "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," end"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Dec_Revenue'")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Department")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"group by"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"order by"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," id;")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[8]||(s[8]=i("p",null,[l("  其中重点部分就是 "),i("code",null,"SUM(CASE WHEN XX THEN XX else XX END)"),l("，其中的 "),i("code",null,"WHEN"),l(" 和 "),i("code",null,"THEN"),l(" 既可以是字段也可以是函数也可以是简单的值，很简单，语法就能看懂在做什么，不多解释了。")],-1)),s[9]||(s[9]=i("h2",{id:"做完思考",tabindex:"-1"},[l("做完思考 "),i("a",{class:"header-anchor",href:"#做完思考","aria-label":'Permalink to "做完思考"'},"​")],-1)),s[10]||(s[10]=i("p",null,"  由于题目的解法是网上直接搜的答案，当时就在想，SQL 题目的考察点都是偏向没见过的语法，都只能直接查结果，得不到练习思维的效果了，一度想要把 SQL 题过滤掉。最后还是决定留下，每次遇到 SQL 题就直接搜结果学习下，并且多做一道程序题来弥补。把 SQL 的题当做学习。",-1)),s[11]||(s[11]=i("h2",{id:"🤟-👉-🎁-🍫",tabindex:"-1"},[l("🤟 👉 🎁 🍫 "),i("a",{class:"header-anchor",href:"#🤟-👉-🎁-🍫","aria-label":'Permalink to "🤟 👉 🎁 🍫"'},"​")],-1)),s[12]||(s[12]=i("p",null,"  正如《阿甘正传》里说的那样：”Life is like a box of chocolate, you never konw what you’ll gonna get“。我也没想到这种不常用的 SQL 还会有排上用场的时候。   场景是这样的：现在提供一个接口，实现的是自动生成调拨方案，存在表中的结构是由方案ID、商品ID、发货仓库、收货仓库四个字段唯一确定的一条记录，字段还包括当前商品的名称、当前商品的调拨数量等信息。如下表：",-1)),s[13]||(s[13]=i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"id"),i("th",null,"plan_id"),i("th",null,"goods_id"),i("th",null,"goods_name"),i("th",null,"from"),i("th",null,"to"),i("th",null,"number")])]),i("tbody",null,[i("tr",null,[i("td",null,"1"),i("td",null,"31029"),i("td",null,"A123"),i("td",null,"小米10 Pro"),i("td",null,"31024"),i("td",null,"31028"),i("td",null,"20")])])],-1)),s[14]||(s[14]=i("p",null,[l("  上述的一条记录表示的是：创建的自动调拨方案 31029 中有一条调拨记录，需要将 20 只小米 10 Pro手机(ID: A123)从 31024 仓库调拨到 31028 仓库。   现在需要提供一个界面，供用户查询一个调拨方案的详表，其中每一行代表了一种商品，一列数据代表了一个[发货仓]-[收货仓]的对应关系，如果该商品在这个调拨关系上没有数据则留空。最终效果如下图（来自于系统原型图）： "),i("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/%E6%99%BA%E8%83%BD%E8%B0%83%E6%8B%A8%E6%95%88%E6%9E%9C%E5%9B%BE.png",alt:"智能调拨效果"})],-1)),s[15]||(s[15]=i("p",null,"  一开始考虑的技术方案是，将表中对应的所有数据项都查询出来，然后通过程序去做数据的聚合，整理出来的思路如下：",-1)),s[16]||(s[16]=i("pre",null,[i("code",null,`显示调拨方案详情：
- 查询得到List<Item>     items
- 所有的 MihomeFrom-MihomeTo pair 做成 HashSet
- 生成 Headers
- Sku 过滤成 HashSet sku
- foreach sku in skus
- - foreach item in items.filter(sku)
- - data.add(item.mihomeFrom-item.mihomeTo, item.number)
导出报表：使用显示详情的接口，并将 header+data 的结果转换成 csv
- header转换成 ArrayList
- data 也转换成同大小的 ArrayList，并 search 到对应的值
`)],-1)),s[17]||(s[17]=i("p",null,[l("  后来回忆起做过的做过的 LeetCode 题目，可以看出，上表中的每一行记录对应了原型图中的表格的每一个格点，这个业务场景就完美契合了上面题目的考察点：对原始表中的数据进行特定情况的聚合，生成新的数据列。不同的地方在于，例题中的数据列是给定的12个月，而当前的业务需要根据数据的特点动态生成。这一难点在Mybatis中也比较好解决：Mapper.xml 作为DAL层访问数据库的代理，既可以传入参数，也支持一些简单的逻辑操作指令，比如for循环插入"),i("code",null,"SUM"),l("函数就可以实现生成动态列的效果。")],-1)),s[18]||(s[18]=i("h2",{id:"解决方案",tabindex:"-1"},[l("解决方案 "),i("a",{class:"header-anchor",href:"#解决方案","aria-label":'Permalink to "解决方案"'},"​")],-1)),s[19]||(s[19]=i("h3",{id:"_1-查询出所需的所有动态列数据",tabindex:"-1"},[l("1. 查询出所需的所有动态列数据 "),i("a",{class:"header-anchor",href:"#_1-查询出所需的所有动态列数据","aria-label":'Permalink to "1. 查询出所需的所有动态列数据"'},"​")],-1)),s[20]||(s[20]=i("p",null,"SQL：",-1)),s[21]||(s[21]=i("div",{class:"language-sql"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sql"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"select"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mihome_from, mihome_to "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," plan_test "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," l "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"where"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"plan_id"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[22]||(s[22]=i("p",null,"结果集：",-1)),s[23]||(s[23]=i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"mihome_from"),i("th",null,"mihome_to")])]),i("tbody",null,[i("tr",null,[i("td",null,"1"),i("td",null,"10")]),i("tr",null,[i("td",null,"1"),i("td",null,"12")]),i("tr",null,[i("td",null,"2"),i("td",null,"10")]),i("tr",null,[i("td",null,"3"),i("td",null,"14")])])],-1)),s[24]||(s[24]=i("p",null,"  将上述结果用一个数据结构 List<MihomePair> 保存起来，在下一步中使用。",-1)),s[25]||(s[25]=i("h3",{id:"_2-动态构建-sql",tabindex:"-1"},[l("2. 动态构建 SQL "),i("a",{class:"header-anchor",href:"#_2-动态构建-sql","aria-label":'Permalink to "2. 动态构建 SQL"'},"​")],-1)),s[26]||(s[26]=i("p",null,"mapper.xml:",-1)),s[27]||(s[27]=i("div",{class:"language-xml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"select"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"selectDetailTable"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," resultType"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"java.util.HashMap"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"select sku, goods_id,goods_name,")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"foreach"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," collection"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"mihomePair"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," index"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"index"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," item"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pair"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," separator"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'","'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  SUM(CASE WHEN mihome_from=#{pair.from} and mihome_to = #{pair_to} then number else null end) as '#{pair.from}-#{pair_to}'")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  </"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"foreach"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"from plan_test where plan_id = 1 group by sku,goods_id, goods_name")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"select"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[28]||(s[28]=i("p",null,[l("SQL 执行结果： "),i("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/%E6%99%BA%E8%83%BD%E8%B0%83%E6%8B%A8%E5%8A%A8%E6%80%81SQL.png",alt:"智能调拨动态SQL"})],-1)),s[29]||(s[29]=i("h3",{id:"输出结果",tabindex:"-1"},[l("输出结果 "),i("a",{class:"header-anchor",href:"#输出结果","aria-label":'Permalink to "输出结果"'},"​")],-1)),s[30]||(s[30]=i("p",null,[l("  结果集"),i("code",null,"HashMap"),l("中的"),i("code",null,"KeySet"),l("自身可以作为表头，稍转换下即可返回，数据项都符合前端需要的格式，也可以直接返回。")],-1)),s[31]||(s[31]=i("p",null,"  该结果可以进一步转换成 SKU 作为键的 List，供用户的更新操作方便操作原始数据。也可以将 KeySet 转换为 List，数据列从 Map 转换成数组，方便导出 CSV 格式的文件。",-1)),s[32]||(s[32]=i("h2",{id:"项目实践",tabindex:"-1"},[l("项目实践 "),i("a",{class:"header-anchor",href:"#项目实践","aria-label":'Permalink to "项目实践"'},"​")],-1)),s[33]||(s[33]=i("p",null,"  在智能调拨项目中将这个技术点应用到实践中，最终实现的效果如下：",-1)),s[34]||(s[34]=i("p",null,[l("** 请求响应 json ** "),i("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/json.png",alt:"响应"})],-1)),s[35]||(s[35]=i("p",null,"** 用户界面 **",-1)),s[36]||(s[36]=i("figure",null,[i("img",{src:"https://xiaohaoxing-1257815318.cos.ap-chengdu.myqcloud.com/%E7%95%8C%E9%9D%A2.png",alt:"界面",loading:"lazy",decoding:"async"})],-1)),s[37]||(s[37]=i("h2",{id:"思考",tabindex:"-1"},[l("思考 "),i("a",{class:"header-anchor",href:"#思考","aria-label":'Permalink to "思考"'},"​")],-1)),s[38]||(s[38]=i("p",null,"  这个问题看似简单，但是可以反映出一些有意思的观点：”世界上没有错误的道路，他们最终都走向正确“。不要放弃平时的积累，也许他们会在意想不到的时候给你一个bonus~",-1))]),"main-header":t(()=>[h(a.$slots,"main-header")]),"main-header-after":t(()=>[h(a.$slots,"main-header-after")]),"main-nav":t(()=>[h(a.$slots,"main-nav")]),"main-content-before":t(()=>[h(a.$slots,"main-content-before")]),"main-content":t(()=>[h(a.$slots,"main-content")]),"main-content-after":t(()=>[h(a.$slots,"main-content-after")]),"main-nav-before":t(()=>[h(a.$slots,"main-nav-before")]),"main-nav-after":t(()=>[h(a.$slots,"main-nav-after")]),comment:t(()=>[h(a.$slots,"comment")]),footer:t(()=>[h(a.$slots,"footer")]),aside:t(()=>[h(a.$slots,"aside")]),"aside-custom":t(()=>[h(a.$slots,"aside-custom")]),default:t(()=>[h(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{U as default,b as usePageData};
